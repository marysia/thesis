I tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcublas.so locally
I tensorflow/stream_executor/dso_loader.cc:119] Couldn't open CUDA library libcudnn.so. LD_LIBRARY_PATH: 
I tensorflow/stream_executor/cuda/cuda_dnn.cc:3459] Unable to load cuDNN DSO
I tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcufft.so locally
I tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcuda.so.1 locally
I tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcurand.so locally
I tensorflow/core/common_runtime/gpu/gpu_device.cc:885] Found device 0 with properties: 
name: Tesla K80
major: 3 minor: 7 memoryClockRate (GHz) 0.8235
pciBusID 0000:84:00.0
Total memory: 11.17GiB
Free memory: 390.38MiB
W tensorflow/stream_executor/cuda/cuda_driver.cc:590] creating context when one is currently active; existing: 0x4c70750
I tensorflow/core/common_runtime/gpu/gpu_device.cc:885] Found device 1 with properties: 
name: Tesla K80
major: 3 minor: 7 memoryClockRate (GHz) 0.8235
pciBusID 0000:85:00.0
Total memory: 11.17GiB
Free memory: 390.38MiB
W tensorflow/stream_executor/cuda/cuda_driver.cc:590] creating context when one is currently active; existing: 0x4c74590
I tensorflow/core/common_runtime/gpu/gpu_device.cc:885] Found device 2 with properties: 
name: Tesla K80
major: 3 minor: 7 memoryClockRate (GHz) 0.8235
pciBusID 0000:88:00.0
Total memory: 11.17GiB
Free memory: 390.38MiB
W tensorflow/stream_executor/cuda/cuda_driver.cc:590] creating context when one is currently active; existing: 0x4c783d0
I tensorflow/core/common_runtime/gpu/gpu_device.cc:885] Found device 3 with properties: 
name: Tesla K80
major: 3 minor: 7 memoryClockRate (GHz) 0.8235
pciBusID 0000:89:00.0
Total memory: 11.17GiB
Free memory: 391.38MiB
I tensorflow/core/common_runtime/gpu/gpu_device.cc:906] DMA: 0 1 2 3 
I tensorflow/core/common_runtime/gpu/gpu_device.cc:916] 0:   Y Y Y Y 
I tensorflow/core/common_runtime/gpu/gpu_device.cc:916] 1:   Y Y Y Y 
I tensorflow/core/common_runtime/gpu/gpu_device.cc:916] 2:   Y Y Y Y 
I tensorflow/core/common_runtime/gpu/gpu_device.cc:916] 3:   Y Y Y Y 
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0)
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0)
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:88:00.0)
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:89:00.0)
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0)
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0)
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:88:00.0)
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:89:00.0)
I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (256): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (512): 	Total Chunks: 1, Chunks in use: 0 512B allocated for chunks. 4B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (1024): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (2048): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (4096): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (8192): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (16384): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (32768): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (65536): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (131072): 	Total Chunks: 1, Chunks in use: 0 208.5KiB allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (262144): 	Total Chunks: 1, Chunks in use: 0 432.0KiB allocated for chunks. 432.0KiB client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (524288): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (1048576): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (2097152): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (4194304): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (8388608): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (16777216): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (33554432): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (67108864): 	Total Chunks: 1, Chunks in use: 0 98.59MiB allocated for chunks. 216.0KiB client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (134217728): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (268435456): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
I tensorflow/core/common_runtime/bfc_allocator.cc:660] Bin for 425.25MiB was 256.00MiB, Chunk State: 
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1314380000 of size 1280
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1314380500 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1314380600 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1314380700 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1314380800 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1314380900 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1314380a00 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1314380b00 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1314380c00 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1314380d00 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1314380e00 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1314380f00 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1314381000 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1314381100 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1314381200 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1314381300 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1314381400 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1314381500 of size 3584
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1314382300 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1314382400 of size 221184
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13143b8400 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13143b8500 of size 442368
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1314424500 of size 18579456
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155dc500 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155dc600 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155dc700 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155dc800 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155dc900 of size 1280
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155dce00 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155dcf00 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155dd000 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155dd100 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155dd200 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155dd300 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155dd400 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155dd500 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155dd600 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155dd700 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155dd800 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155dd900 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155dda00 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155ddb00 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155ddc00 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155ddd00 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155dde00 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155ddf00 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155de000 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155de100 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155de200 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155de300 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155de400 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155de500 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155de600 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155de700 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155de800 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155de900 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155dea00 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155deb00 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155dec00 of size 768
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155def00 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155df000 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155df300 of size 768
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1315613800 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x131567f900 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x131567fa00 of size 18579456
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1316837a00 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1316837b00 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1316837c00 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1316837d00 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1316837e00 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1316837f00 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1316838000 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1316838100 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1316838200 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1316838300 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1316838400 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1316838500 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1316838600 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1316838700 of size 3584
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1316839500 of size 3584
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x131683a300 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x131683a400 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x131683a500 of size 221184
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1316870500 of size 221184
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13168a6500 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13168a6600 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13168a6700 of size 442368
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1316912700 of size 442368
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x131697e700 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x131697e800 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x131697e900 of size 18579456
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1317b36900 of size 18579456
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1318cee900 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1318ceea00 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1318ceeb00 of size 3584
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1318cef900 of size 221184
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1318d25900 of size 442368
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1318d91900 of size 18579456
I tensorflow/core/common_runtime/bfc_allocator.cc:687] Free at 0x13155df100 of size 512
I tensorflow/core/common_runtime/bfc_allocator.cc:687] Free at 0x13155df600 of size 213504
I tensorflow/core/common_runtime/bfc_allocator.cc:687] Free at 0x1315613900 of size 442368
I tensorflow/core/common_runtime/bfc_allocator.cc:687] Free at 0x1319f49900 of size 103376640
I tensorflow/core/common_runtime/bfc_allocator.cc:693]      Summary of in-use Chunks by size: 
I tensorflow/core/common_runtime/bfc_allocator.cc:696] 77 Chunks of size 256 totalling 19.2KiB
I tensorflow/core/common_runtime/bfc_allocator.cc:696] 2 Chunks of size 768 totalling 1.5KiB
I tensorflow/core/common_runtime/bfc_allocator.cc:696] 2 Chunks of size 1280 totalling 2.5KiB
I tensorflow/core/common_runtime/bfc_allocator.cc:696] 4 Chunks of size 3584 totalling 14.0KiB
I tensorflow/core/common_runtime/bfc_allocator.cc:696] 4 Chunks of size 221184 totalling 864.0KiB
I tensorflow/core/common_runtime/bfc_allocator.cc:696] 4 Chunks of size 442368 totalling 1.69MiB
I tensorflow/core/common_runtime/bfc_allocator.cc:696] 5 Chunks of size 18579456 totalling 88.59MiB
I tensorflow/core/common_runtime/bfc_allocator.cc:700] Sum Total of in-use chunks: 91.16MiB
I tensorflow/core/common_runtime/bfc_allocator.cc:702] Stats: 
Limit:                   199622656
InUse:                    95589632
MaxInUse:                 95589888
NumAllocs:                     117
MaxAllocSize:             18579456

W tensorflow/core/common_runtime/bfc_allocator.cc:274] *****************xx******************************___________________________________________________
W tensorflow/core/common_runtime/bfc_allocator.cc:275] Ran out of memory trying to allocate 425.25MiB.  See logs for memory state.
W tensorflow/core/framework/op_kernel.cc:975] Resource exhausted: OOM when allocating tensor with shape[96,7,72,72,32]
(2368, 2)
(2368, 7, 72, 72, 1)
Network created.
---------------------------------
Run id: lung_cnn
Log directory: /tmp/tflearn_logs/
[?25l---------------------------------
Training samples: 2000
Validation samples: 100
--
[B[B[B--
[?12;25hTraceback (most recent call last):
  File "3dconvnet.py", line 56, in <module>
    show_metric=True, batch_size=96, run_id='lung_cnn')
  File "/home/marysia/thesis/venv/local/lib/python2.7/site-packages/tflearn/models/dnn.py", line 214, in fit
    callbacks=callbacks)
  File "/home/marysia/thesis/venv/local/lib/python2.7/site-packages/tflearn/helpers/trainer.py", line 333, in fit
    show_metric)
  File "/home/marysia/thesis/venv/local/lib/python2.7/site-packages/tflearn/helpers/trainer.py", line 774, in _train
    feed_batch)
  File "/home/marysia/thesis/venv/local/lib/python2.7/site-packages/tensorflow/python/client/session.py", line 766, in run
    run_metadata_ptr)
  File "/home/marysia/thesis/venv/local/lib/python2.7/site-packages/tensorflow/python/client/session.py", line 964, in _run
    feed_dict_string, options, run_metadata)
  File "/home/marysia/thesis/venv/local/lib/python2.7/site-packages/tensorflow/python/client/session.py", line 1014, in _do_run
    target_list, options, run_metadata)
  File "/home/marysia/thesis/venv/local/lib/python2.7/site-packages/tensorflow/python/client/session.py", line 1034, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.ResourceExhaustedError: OOM when allocating tensor with shape[96,7,72,72,32]
	 [[Node: Conv3D/Conv3D = Conv3D[T=DT_FLOAT, padding="SAME", strides=[1, 1, 1, 1, 1], _device="/job:localhost/replica:0/task:0/gpu:0"](_recv_InputData/X_0/_15, Conv3D/W/read)]]
	 [[Node: Accuracy/Mean/_21 = _Recv[client_terminated=false, recv_device="/job:localhost/replica:0/task:0/cpu:0", send_device="/job:localhost/replica:0/task:0/gpu:0", send_device_incarnation=1, tensor_name="edge_438_Accuracy/Mean", tensor_type=DT_FLOAT, _device="/job:localhost/replica:0/task:0/cpu:0"]()]]

Caused by op u'Conv3D/Conv3D', defined at:
  File "3dconvnet.py", line 40, in <module>
    network = conv_3d(network, 32, 3, activation='relu')
  File "/home/marysia/thesis/venv/local/lib/python2.7/site-packages/tflearn/layers/conv.py", line 803, in conv_3d
    inference = tf.nn.conv3d(incoming, W, strides, padding)
  File "/home/marysia/thesis/venv/local/lib/python2.7/site-packages/tensorflow/python/ops/gen_nn_ops.py", line 522, in conv3d
    strides=strides, padding=padding, name=name)
  File "/home/marysia/thesis/venv/local/lib/python2.7/site-packages/tensorflow/python/framework/op_def_library.py", line 759, in apply_op
    op_def=op_def)
  File "/home/marysia/thesis/venv/local/lib/python2.7/site-packages/tensorflow/python/framework/ops.py", line 2240, in create_op
    original_op=self._default_original_op, op_def=op_def)
  File "/home/marysia/thesis/venv/local/lib/python2.7/site-packages/tensorflow/python/framework/ops.py", line 1128, in __init__
    self._traceback = _extract_stack()

ResourceExhaustedError (see above for traceback): OOM when allocating tensor with shape[96,7,72,72,32]
	 [[Node: Conv3D/Conv3D = Conv3D[T=DT_FLOAT, padding="SAME", strides=[1, 1, 1, 1, 1], _device="/job:localhost/replica:0/task:0/gpu:0"](_recv_InputData/X_0/_15, Conv3D/W/read)]]
	 [[Node: Accuracy/Mean/_21 = _Recv[client_terminated=false, recv_device="/job:localhost/replica:0/task:0/cpu:0", send_device="/job:localhost/replica:0/task:0/gpu:0", send_device_incarnation=1, tensor_name="edge_438_Accuracy/Mean", tensor_type=DT_FLOAT, _device="/job:localhost/replica:0/task:0/cpu:0"]()]]

I tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcublas.so locally
I tensorflow/stream_executor/dso_loader.cc:119] Couldn't open CUDA library libcudnn.so. LD_LIBRARY_PATH: 
I tensorflow/stream_executor/cuda/cuda_dnn.cc:3459] Unable to load cuDNN DSO
I tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcufft.so locally
I tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcuda.so.1 locally
I tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcurand.so locally
I tensorflow/core/common_runtime/gpu/gpu_device.cc:885] Found device 0 with properties: 
name: Tesla K80
major: 3 minor: 7 memoryClockRate (GHz) 0.8235
pciBusID 0000:84:00.0
Total memory: 11.17GiB
Free memory: 390.38MiB
W tensorflow/stream_executor/cuda/cuda_driver.cc:590] creating context when one is currently active; existing: 0x3ff0750
I tensorflow/core/common_runtime/gpu/gpu_device.cc:885] Found device 1 with properties: 
name: Tesla K80
major: 3 minor: 7 memoryClockRate (GHz) 0.8235
pciBusID 0000:85:00.0
Total memory: 11.17GiB
Free memory: 390.38MiB
W tensorflow/stream_executor/cuda/cuda_driver.cc:590] creating context when one is currently active; existing: 0x3ff4590
I tensorflow/core/common_runtime/gpu/gpu_device.cc:885] Found device 2 with properties: 
name: Tesla K80
major: 3 minor: 7 memoryClockRate (GHz) 0.8235
pciBusID 0000:88:00.0
Total memory: 11.17GiB
Free memory: 390.38MiB
W tensorflow/stream_executor/cuda/cuda_driver.cc:590] creating context when one is currently active; existing: 0x3ff83d0
I tensorflow/core/common_runtime/gpu/gpu_device.cc:885] Found device 3 with properties: 
name: Tesla K80
major: 3 minor: 7 memoryClockRate (GHz) 0.8235
pciBusID 0000:89:00.0
Total memory: 11.17GiB
Free memory: 391.38MiB
I tensorflow/core/common_runtime/gpu/gpu_device.cc:906] DMA: 0 1 2 3 
I tensorflow/core/common_runtime/gpu/gpu_device.cc:916] 0:   Y Y Y Y 
I tensorflow/core/common_runtime/gpu/gpu_device.cc:916] 1:   Y Y Y Y 
I tensorflow/core/common_runtime/gpu/gpu_device.cc:916] 2:   Y Y Y Y 
I tensorflow/core/common_runtime/gpu/gpu_device.cc:916] 3:   Y Y Y Y 
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0)
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0)
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:88:00.0)
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:89:00.0)
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:84:00.0)
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:85:00.0)
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:2) -> (device: 2, name: Tesla K80, pci bus id: 0000:88:00.0)
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:3) -> (device: 3, name: Tesla K80, pci bus id: 0000:89:00.0)
I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (256): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (512): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (1024): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (2048): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (4096): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (8192): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (16384): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (32768): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (65536): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (131072): 	Total Chunks: 1, Chunks in use: 0 209.0KiB allocated for chunks. 4B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (262144): 	Total Chunks: 1, Chunks in use: 0 432.0KiB allocated for chunks. 432.0KiB client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (524288): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (1048576): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (2097152): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (4194304): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (8388608): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (16777216): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (33554432): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (67108864): 	Total Chunks: 1, Chunks in use: 0 98.59MiB allocated for chunks. 216.0KiB client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (134217728): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
I tensorflow/core/common_runtime/bfc_allocator.cc:643] Bin (268435456): 	Total Chunks: 0, Chunks in use: 0 0B allocated for chunks. 0B client-requested for chunks. 0B in use in bin. 0B client-requested in use in bin.
I tensorflow/core/common_runtime/bfc_allocator.cc:660] Bin for 425.25MiB was 256.00MiB, Chunk State: 
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1314380000 of size 1280
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1314380500 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1314380600 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1314380700 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1314380800 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1314380900 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1314380a00 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1314380b00 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1314380c00 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1314380d00 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1314380e00 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1314380f00 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1314381000 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1314381100 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1314381200 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1314381300 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1314381400 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1314381500 of size 3584
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1314382300 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1314382400 of size 221184
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13143b8400 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13143b8500 of size 442368
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1314424500 of size 18579456
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155dc500 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155dc600 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155dc700 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155dc800 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155dc900 of size 1280
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155dce00 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155dcf00 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155dd000 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155dd100 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155dd200 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155dd300 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155dd400 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155dd500 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155dd600 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155dd700 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155dd800 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155dd900 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155dda00 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155ddb00 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155ddc00 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155ddd00 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155dde00 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155ddf00 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155de000 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155de100 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155de200 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155de300 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155de400 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155de500 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155de600 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155de700 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155de800 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155de900 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155dea00 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155deb00 of size 768
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155dee00 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155def00 of size 768
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155df200 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13155df300 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1315613800 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x131567f900 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x131567fa00 of size 18579456
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1316837a00 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1316837b00 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1316837c00 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1316837d00 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1316837e00 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1316837f00 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1316838000 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1316838100 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1316838200 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1316838300 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1316838400 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1316838500 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1316838600 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1316838700 of size 3584
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1316839500 of size 3584
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x131683a300 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x131683a400 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x131683a500 of size 221184
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1316870500 of size 221184
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13168a6500 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13168a6600 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x13168a6700 of size 442368
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1316912700 of size 442368
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x131697e700 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x131697e800 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x131697e900 of size 18579456
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1317b36900 of size 18579456
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1318cee900 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1318ceea00 of size 256
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1318ceeb00 of size 3584
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1318cef900 of size 221184
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1318d25900 of size 442368
I tensorflow/core/common_runtime/bfc_allocator.cc:678] Chunk at 0x1318d91900 of size 18579456
I tensorflow/core/common_runtime/bfc_allocator.cc:687] Free at 0x13155df400 of size 214016
I tensorflow/core/common_runtime/bfc_allocator.cc:687] Free at 0x1315613900 of size 442368
I tensorflow/core/common_runtime/bfc_allocator.cc:687] Free at 0x1319f49900 of size 103376640
I tensorflow/core/common_runtime/bfc_allocator.cc:693]      Summary of in-use Chunks by size: 
I tensorflow/core/common_runtime/bfc_allocator.cc:696] 77 Chunks of size 256 totalling 19.2KiB
I tensorflow/core/common_runtime/bfc_allocator.cc:696] 2 Chunks of size 768 totalling 1.5KiB
I tensorflow/core/common_runtime/bfc_allocator.cc:696] 2 Chunks of size 1280 totalling 2.5KiB
I tensorflow/core/common_runtime/bfc_allocator.cc:696] 4 Chunks of size 3584 totalling 14.0KiB
I tensorflow/core/common_runtime/bfc_allocator.cc:696] 4 Chunks of size 221184 totalling 864.0KiB
I tensorflow/core/common_runtime/bfc_allocator.cc:696] 4 Chunks of size 442368 totalling 1.69MiB
I tensorflow/core/common_runtime/bfc_allocator.cc:696] 5 Chunks of size 18579456 totalling 88.59MiB
I tensorflow/core/common_runtime/bfc_allocator.cc:700] Sum Total of in-use chunks: 91.16MiB
I tensorflow/core/common_runtime/bfc_allocator.cc:702] Stats: 
Limit:                   199622656
InUse:                    95589632
MaxInUse:                 95590144
NumAllocs:                     117
MaxAllocSize:             18579456

W tensorflow/core/common_runtime/bfc_allocator.cc:274] *****************xx******************************___________________________________________________
W tensorflow/core/common_runtime/bfc_allocator.cc:275] Ran out of memory trying to allocate 425.25MiB.  See logs for memory state.
W tensorflow/core/framework/op_kernel.cc:975] Resource exhausted: OOM when allocating tensor with shape[96,7,72,72,32]
(2368, 2)
(2368, 7, 72, 72, 1)
Network created.
---------------------------------
Run id: lung_cnn
Log directory: /tmp/tflearn_logs/
[?25l---------------------------------
Training samples: 2000
Validation samples: 100
--
[B[B[B--
[?12;25hTraceback (most recent call last):
  File "3dconvnet.py", line 56, in <module>
    show_metric=True, batch_size=96, run_id='lung_cnn')
  File "/home/marysia/thesis/venv/local/lib/python2.7/site-packages/tflearn/models/dnn.py", line 214, in fit
    callbacks=callbacks)
  File "/home/marysia/thesis/venv/local/lib/python2.7/site-packages/tflearn/helpers/trainer.py", line 333, in fit
    show_metric)
  File "/home/marysia/thesis/venv/local/lib/python2.7/site-packages/tflearn/helpers/trainer.py", line 774, in _train
    feed_batch)
  File "/home/marysia/thesis/venv/local/lib/python2.7/site-packages/tensorflow/python/client/session.py", line 766, in run
    run_metadata_ptr)
  File "/home/marysia/thesis/venv/local/lib/python2.7/site-packages/tensorflow/python/client/session.py", line 964, in _run
    feed_dict_string, options, run_metadata)
  File "/home/marysia/thesis/venv/local/lib/python2.7/site-packages/tensorflow/python/client/session.py", line 1014, in _do_run
    target_list, options, run_metadata)
  File "/home/marysia/thesis/venv/local/lib/python2.7/site-packages/tensorflow/python/client/session.py", line 1034, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.ResourceExhaustedError: OOM when allocating tensor with shape[96,7,72,72,32]
	 [[Node: Conv3D/Conv3D = Conv3D[T=DT_FLOAT, padding="SAME", strides=[1, 1, 1, 1, 1], _device="/job:localhost/replica:0/task:0/gpu:0"](_recv_InputData/X_0/_15, Conv3D/W/read)]]
	 [[Node: Accuracy/Mean/_21 = _Recv[client_terminated=false, recv_device="/job:localhost/replica:0/task:0/cpu:0", send_device="/job:localhost/replica:0/task:0/gpu:0", send_device_incarnation=1, tensor_name="edge_438_Accuracy/Mean", tensor_type=DT_FLOAT, _device="/job:localhost/replica:0/task:0/cpu:0"]()]]

Caused by op u'Conv3D/Conv3D', defined at:
  File "3dconvnet.py", line 40, in <module>
    network = conv_3d(network, 32, 3, activation='relu')
  File "/home/marysia/thesis/venv/local/lib/python2.7/site-packages/tflearn/layers/conv.py", line 803, in conv_3d
    inference = tf.nn.conv3d(incoming, W, strides, padding)
  File "/home/marysia/thesis/venv/local/lib/python2.7/site-packages/tensorflow/python/ops/gen_nn_ops.py", line 522, in conv3d
    strides=strides, padding=padding, name=name)
  File "/home/marysia/thesis/venv/local/lib/python2.7/site-packages/tensorflow/python/framework/op_def_library.py", line 759, in apply_op
    op_def=op_def)
  File "/home/marysia/thesis/venv/local/lib/python2.7/site-packages/tensorflow/python/framework/ops.py", line 2240, in create_op
    original_op=self._default_original_op, op_def=op_def)
  File "/home/marysia/thesis/venv/local/lib/python2.7/site-packages/tensorflow/python/framework/ops.py", line 1128, in __init__
    self._traceback = _extract_stack()

ResourceExhaustedError (see above for traceback): OOM when allocating tensor with shape[96,7,72,72,32]
	 [[Node: Conv3D/Conv3D = Conv3D[T=DT_FLOAT, padding="SAME", strides=[1, 1, 1, 1, 1], _device="/job:localhost/replica:0/task:0/gpu:0"](_recv_InputData/X_0/_15, Conv3D/W/read)]]
	 [[Node: Accuracy/Mean/_21 = _Recv[client_terminated=false, recv_device="/job:localhost/replica:0/task:0/cpu:0", send_device="/job:localhost/replica:0/task:0/gpu:0", send_device_incarnation=1, tensor_name="edge_438_Accuracy/Mean", tensor_type=DT_FLOAT, _device="/job:localhost/replica:0/task:0/cpu:0"]()]]

